---
title: "Proyecto Final"
author: "Guillermo Pinto, Carlos García, Jesús Ramírez"
date: "2023-12-02"
output:         
    html_document:      
        code_folding: hide      
editor_options: 
  markdown: 
    wrap: 72
encoding: UTF-8
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

# Pruebas Icfes Saber 11 del segundo semestre del año 2022 {.tabset}

## Introducción

1.1	Planteamiento del problema:
En el contexto educativo actual, comprender los factores que influyen en el rendimiento académico de los estudiantes es fundamental. Por ello, el objetivo de este proyecto es investigar y analizar en profundidad los determinantes detrás de los resultados obtenidos en las pruebas Saber 11.
1.2	¿Como se abordará el problema?
Se estudia un conjunto de datos que contiene información general distribuida en cuatro categorías principales: estudiante, familia, colegio y aspectos relacionados con la prueba. Los análisis se realizan a través de Rstudio.
1.3	Técnica analítica usada:
Se usan técnicas estadísticas y demográficas como la correlación de variables para describir relaciones entre columnas, así como análisis de gráficos y un análisis espacial.
1.4	Beneficio de nuestro análisis para el consumidor:
Es importante señalar que el examen Saber 11 es un referente clave en la evaluación del sistema educativo colombiano. Por lo tanto, explorar los elementos que impactan sus resultados puede ofrecer valiosas perspectivas para mejorar el proceso educativo.

## Paquetes requeridos 

Para reproducir el código y los resultados a lo largo de este proyecto, fue necesario cargar los siguientes paquetes.

- **knitr:** Se utiliza para mostrar una tabla alineada en la pantalla.
- **DT**: Usado para presentar datos en formato desplazable y ordenable.
- **ggplot2**: Usada para crear visualizaciones gráficas a partir de datos.
- **sf**: Usada para el manejo de datos geoespaciales.
- **dplyr**: Usada para la manipulación de datos y operaciones JOIN.
- **tmap**: Usada para representar mapas geográficos.
- **reshape2**: Usada para reorganizar y transformar datos.
- **tidyr**: Usada para ajustar la estructura de los datos para análisis.
- **gridExtra**: Usada para juntar dos gráficos en un solo plot.

``` {r packages_false, echo=TRUE, eval=FALSE}
library(knitr)
library(DT)
library(ggplot2) # visualizing data
library(sf) # trabajar con tipos de datos geográficos
library(dplyr) # realizar JOIN
library(tmap) # graficar mapas
library(reshape2)
library(tidyr)
library(gridExtra)
```

```{r packages_true, echo=FALSE, eval=TRUE}
library(knitr)
library(DT)
library(ggplot2)
suppressPackageStartupMessages(library(dplyr))
library(sf)
library(dplyr)
library(tmap)
library(reshape2)
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(gridExtra))
```

## Preparación de datos {.tabset .tabset-fade}

### Importación de datos

#### Resultados anonimizados de las pruebas Icfes Saber 11 del segundo semestre del año 2022.

El propósito original de los datos es proporcionar información valiosa y
oportuna sobre estudiantes que participan en las pruebas Saber,
incluyendo sus resultados académicos y datos socioeconómicos. Estos
datos, publicados por el Instituto Colombiano para la Evaluación de la
Educación (Icfes) en el repositorio DataIcfes, buscan contribuir al
mejoramiento de la calidad educativa en Colombia al ofrecer información
confiable y pertinente para análisis e investigaciones que incidan
positivamente en el sistema educativo del país.

Los datos se recopilan principalmente el día que los estudiantes
presentan la prueba. A partir de las respuestas proporcionadas en el
cuestionario sociodemográfico y las cinco pruebas en cada área del
conocimiento, se recopila información personal, de contacto, familiar,
así como datos del colegio y de citación. Los resultados, que incluyen
puntajes, percentiles y niveles socioeconómicos, se calculan con base en
los datos recolectados durante la presentación de las pruebas.

Este conjunto de datos abarca 82 variables que capturan una amplia gama
de factores socioeconómicos, demográficos y académicos a lo largo de
532,792 registros. Proporciona información sobre el rendimiento
académico, antecedentes familiares, instituciones educativas y puntajes
de pruebas entre estudiantes, cubriendo una amplia gama de contextos
socioeducativos. Además, ofrece información detallada sobre ubicaciones
geográficas, distribución de género y acceso a recursos dentro de
diversas comunidades.

Se puede incontrar más información sobre el conjunto de datos en la
página del Instituto Colombiano para la Evaluación de la Educación -
ICFES (2023). *DataIcfes. Saber 11.*
<https://www.icfes.gov.co/web/guest/data-icfes>

Nuestra exploración de datos inició con la tabla inicial provista por
[Datos.gov.co](https://www.datos.gov.co/Educaci-n/Saber-11-2019-2/ynam-yc42#),
revelando una estructura compleja y columnas poco claras. Accedimos al
diccionario de datos a través de DataIcfes, una base independiente del
Icfes. Tras solicitar acceso, encontramos información extensa sobre
pruebas Saber 11 desde 2001 hasta 2022 y escogimos los datos más
actualizados. A pesar de intentos fallidos de importar archivos .txt en
R debido al separador '¬', optamos por LibreOffice Calc para
convertirlos a CSV con separador ','. Posteriormente, logramos importar
con éxito en R usando read.csv, facilitando nuestro análisis.

```{r import_data}
ruta_datos <- "SB11_20222.csv"
data <- read.csv(ruta_datos, sep = ",", dec = ".", header = TRUE, stringsAsFactors = TRUE)

# Verificar la clase del objeto
class(data)
# Ver los nombres de las columnas
colnames(data)
# Contar la cantidad de registros y columnas
dim(data)
```

### Limpieza de datos

#### Datos irrelevantes

La limpieza de datos es crucial para garantizar la precisión y
coherencia en el análisis. Nuestro proceso de limpieza se basó en pasos
lógicos y específicos. Primero, identificamos columnas irrelevantes para
nuestro análisis, eliminándolas para focalizarnos en datos pertinentes.

Las columnas eliminadas abarcaban detalles específicos y contextuales
poco relevantes para nuestro análisis. Incluían información sobre la
estructura familiar, ocupación de los padres, alimentación y cantidad de 
habitaciones en el hogar, así como datos relacionados con el tipo de documento,
nacionalidad, género, período de presentación del examen, entre otros.

Estos detalles, aunque podrían ser importantes en otros contextos, no
aportaban directamente a nuestras investigaciones sobre la correlación
entre variables socioeconómicas, demográficas y el rendimiento académico. 
Su exclusión nos permitió concentrarnos en datos más pertinentes y directamente
vinculados a nuestras áreas de estudio, optimizando así la calidad y relevancia
de nuestro análisis.

```{r clean_data}
columnas_relevantes <- c(
    "ESTU_NSE_INDIVIDUAL", "PUNT_GLOBAL", "FAMI_TIENECOMPUTADOR",
    "FAMI_ESTRATOVIVIENDA", "COLE_NATURALEZA", "COLE_BILINGUE", 
    "ESTU_DEDICACIONLECTURADIARIA", "ESTU_HORASSEMANATRABAJA",
    "ESTU_TIPOREMUNERACION", "FAMI_EDUCACIONPADRE", "FAMI_EDUCACIONMADRE", 
    "FAMI_NUMLIBROS", "FAMI_TIENEINTERNET", "ESTU_DEDICACIONINTERNET", 
    "DESEMP_LECTURA_CRITICA", "DESEMP_MATEMATICAS", "PUNT_INGLES", 
    "DESEMP_C_NATURALES", "DESEMP_SOCIALES_CIUDADANAS", "PUNT_LECTURA_CRITICA",
    "PUNT_MATEMATICAS", "PUNT_C_NATURALES", "PUNT_SOCIALES_CIUDADANAS",
    "ESTU_COD_RESIDE_DEPTO", "ESTU_COD_RESIDE_MCPIO", "COLE_AREA_UBICACION"
)

data <- data[, columnas_relevantes, drop = FALSE]
```

___

Después de la limpieza de datos, volvemos a comprobar el número de filas
y columnas, como se muestra en el siguiente código.

```{r size_clean_data}
# Contar la cantidad de registros y columnas
dim(data)
```

___

#### Missing values

Iniciamos nuestro análisis tratando valores 'NA' o vacíos de manera general, lo
que resultó en la pérdida de 25K de registros, reduciendo el conjunto a más de
507K de registros para el análisis exploratorio. Aunque significativo, este
enfoque nos brindó una visión inicial de la integridad de nuestros datos.

Posteriormente, ajustamos nuestra estrategia. Optamos por eliminar 'NA' de
manera específica en columnas clave para ciertas preguntas analíticas, como en
la matriz de correlación. Este enfoque nos permitió realizar tratamientos más
precisos en los datos relevantes sin comprometer la integridad global del conjunto.

Esta metodología dual nos ha permitido mantener un tamaño de muestra
representativo y relevante para nuestros análisis generales, al tiempo que
garantiza un tratamiento más específico y detallado donde es necesario. Esta
aproximación se alinea con nuestro objetivo de mantener datos precisos y
completos, asegurando que nuestras interpretaciones sean fundamentadas y confiables.

```{r missing_values}
# Contar la cantidad de NA
sum(is.na(data))

data <- data[complete.cases(data), ] # Quitar los NA del nuevo dataframe

sum(is.na(data))
```

### Previsualización de datos

#### Vista previa del conjunto de datos limpio

En los datos, cada fila es un estudiante y las columnas son la
información socioeconómica, demográfica, académica,  y familiar de la
prueba sobre el estudiante.

```{r prev_data}
library(DT)
datatable(head(data[, 1:10],50))
```

### Descripción de datos

```{r data_desc}
Variable.type <- lapply(data,class)
Variable.desc <- c(
    "Nivel Socioeconómico del evaluado",
    "Puntaje total obtenido",
    "¿Cuáles de los siguientes bienes posee su hogar?: Computador",
    "Estrato socioeconómico de la vivienda según recibo de energía eléctrica",
    "Indica la naturaleza del Establecimiento (Privado o público)",
    "Indica si el Establecimiento es bilingüe o no",
    "Usualmente, ¿cuánto tiempo al día dedica a leer por entretenimiento?",
    "¿Cuántas horas trabajó usted durante la semana pasada?",
    "Tipo de remuneración por trabajar",
    "Nivel educativo más alto alcanzado por el padre",
    "Nivel educativo más alto alcanzado por la madre",
    "¿Cuántos libros físicos o electrónicos hay en su hogar excluyendo periódicos, revistas, directorios telefónicos y libros del colegio?",
    "¿Su hogar cuenta con servicio o conexión a internet?",
    "Usualmente, ¿cuánto tiempo al día dedica a navegar en internet? Excluya actividades académicas",
    "Desempeño en lectura crítica",
    "Desempeño matemáticas",
    "Puntaje en inglés",
    "Desempeño ciencias naturales",
    "Desempeño sociales y ciudadanas",
    "Puntaje en lectura crítica",
    "Puntaje en matemáticas",
    "Puntaje en ciencias naturales",
    "Puntaje sociales y ciudadanas",
    "Código Dane del departamento de residencia",
    "Código Dane del municipio de residencia",
    "Área de ubicación de la Sede (rural o urbano)"
)

data.desc <- data.frame(
    Data.Type = unlist(Variable.type), 
    Descipcion.Variable = Variable.desc,
    row.names = names(Variable.type)
)

library(knitr)
kable(data.desc, caption = "Diccionario de Datos")
```


## Análisis exploratorio {.tabset .tabset-fade}
### Matriz de correlación

Este código realiza la conversión de variables categóricas (factores) a numéricas, simplificando las etiquetas para mejorar la legibilidad y permitir el análisis estadístico.

Primero, identificamos los niveles de las variables categóricas a convertir, mostrándolos para su inspección. Luego, reordenamos estos niveles para asignarles un orden lógico, donde los valores inferiores tienen asignados números menores. Por ejemplo, en la variable de estrato socioeconómico, se asigna el número 1 al estrato más bajo y así sucesivamente. 

```{r factor_to_numeric}
# Conversión de variables factoriales a numéricas

## Primero se ven los niveles que tiene la variable
levels(data$FAMI_ESTRATOVIVIENDA)

## Luego se ordenan los niveles de menor a mayor
data$FAMI_ESTRATOVIVIENDA <- factor(data$FAMI_ESTRATOVIVIENDA, levels = c("Sin Estrato", "Estrato 1", "Estrato 2", "Estrato 3", "Estrato 4", "Estrato 5", "Estrato 6"))

## Se verifica
levels(data$FAMI_ESTRATOVIVIENDA)

## Se convierte a numero, donde 1 es el nivel inferior, así sucesivamente
data$FAMI_ESTRATOVIVIENDA <- as.numeric(data$FAMI_ESTRATOVIVIENDA)
```

Esto se hace para variables como dedicación diaria a la lectura, horas de trabajo, nivel educativo de los padres, número de libros en el hogar y tiempo de dedicación a internet.

```{r factor_to_numeric_resto, echo = TRUE, collapse = TRUE}
### Para tiempo de lectura diaria por entretenimiento
#levels(data$ESTU_DEDICACIONLECTURADIARIA)
data$ESTU_DEDICACIONLECTURADIARIA <- factor(data$ESTU_DEDICACIONLECTURADIARIA, levels = c("No leo por entretenimiento", "30 minutos o menos", "Entre 1 y 2 horas", "Entre 30 y 60 minutos", "Más de 2 horas"))
#levels(data$ESTU_DEDICACIONLECTURADIARIA)
data$ESTU_DEDICACIONLECTURADIARIA <- as.numeric(data$ESTU_DEDICACIONLECTURADIARIA)

### Para horas que trabaja
#levels(data$ESTU_HORASSEMANATRABAJA)
data$ESTU_HORASSEMANATRABAJA <- factor(data$ESTU_HORASSEMANATRABAJA, levels = c("0", "Menos de 10 horas", "Entre 11 y 20 horas", "Entre 21 y 30 horas", "Más de 30 horas"))
#levels(data$ESTU_HORASSEMANATRABAJA)
data$ESTU_HORASSEMANATRABAJA <- as.numeric(data$ESTU_HORASSEMANATRABAJA)

### Para educacion madre
#levels(data$FAMI_EDUCACIONMADRE)
data$FAMI_EDUCACIONMADRE <- factor(data$FAMI_EDUCACIONMADRE, levels = c("Ninguno", "Primaria incompleta", "Primaria completa", "Secundaria (Bachillerato) incompleta", "Secundaria (Bachillerato) completa", "Técnica o tecnológica incompleta", "Técnica o tecnológica completa", "Educación profesional incompleta", "Educación profesional completa", "Postgrado"))
#levels(data$FAMI_EDUCACIONMADRE)
data$FAMI_EDUCACIONMADRE <- as.numeric(data$FAMI_EDUCACIONMADRE)

### Para educacion padre
#levels(data$FAMI_EDUCACIONPADRE)
data$FAMI_EDUCACIONPADRE <- factor(data$FAMI_EDUCACIONPADRE, levels = c("Ninguno", "Primaria incompleta", "Primaria completa", "Secundaria (Bachillerato) incompleta", "Secundaria (Bachillerato) completa", "Técnica o tecnológica incompleta", "Técnica o tecnológica completa", "Educación profesional incompleta", "Educación profesional completa", "Postgrado"))
#levels(data$FAMI_EDUCACIONPADRE)
data$FAMI_EDUCACIONPADRE <- as.numeric(data$FAMI_EDUCACIONPADRE)

### Para numero de libros
#levels(data$FAMI_NUMLIBROS)
data$FAMI_NUMLIBROS <- factor(data$FAMI_NUMLIBROS, levels = c("0 A 10 LIBROS", "11 A 25 LIBROS", "26 A 100 LIBROS", "MÁS DE 100 LIBROS"))
#levels(data$FAMI_NUMLIBROS)
data$FAMI_NUMLIBROS <- as.numeric(data$FAMI_NUMLIBROS)

### Para tiempo de dedicacion internet
#levels(data$ESTU_DEDICACIONINTERNET)
data$ESTU_DEDICACIONINTERNET <- factor(data$ESTU_DEDICACIONINTERNET, levels = c("No Navega Internet", "30 minutos o menos", "Entre 1 y 3 horas", "Más de 3 horas"))
#levels(data$ESTU_DEDICACIONINTERNET)
data$ESTU_DEDICACIONINTERNET <- as.numeric(data$ESTU_DEDICACIONINTERNET)

### Para tipo de remuneracion
#levels(data$ESTU_TIPOREMUNERACION)
data$ESTU_TIPOREMUNERACION <- factor(data$ESTU_TIPOREMUNERACION, levels = c("No", "Si, en efectivo", "Si, en efectivo y especie", "Si, en especie"))
#levels(data$ESTU_TIPOREMUNERACION)
data$ESTU_TIPOREMUNERACION <- as.numeric(data$ESTU_TIPOREMUNERACION)
```

Después de la conversión, creamos un nuevo dataframe que incluye estas variables numéricas junto con otras variables relevantes como puntajes globales, desempeño en inglés, lectura crítica, matemáticas, ciencias y sociales. Además, se verificó y corrigió la presencia de valores perdidos (NA) en el nuevo dataframe, eliminándolos para garantizar una análisis robusto.

```{r cor_matrix, fig.align='center'}
matrix_df <- data[, c("FAMI_ESTRATOVIVIENDA", "ESTU_DEDICACIONLECTURADIARIA", "ESTU_HORASSEMANATRABAJA", "FAMI_EDUCACIONMADRE", "FAMI_EDUCACIONPADRE", "FAMI_NUMLIBROS", "ESTU_DEDICACIONINTERNET",  "ESTU_NSE_INDIVIDUAL", "ESTU_TIPOREMUNERACION","PUNT_GLOBAL", "PUNT_INGLES", "DESEMP_LECTURA_CRITICA", "DESEMP_MATEMATICAS", "DESEMP_C_NATURALES", "DESEMP_SOCIALES_CIUDADANAS")]

sum(is.na(matrix_df)) # Contar los NA

matrix_df <- matrix_df[complete.cases(matrix_df), ] # Quitar los NA del nuevo dataframe

# Cambiar los nombres de las columnas para una matrix más legible
colnames(matrix_df) <- c("estrato", "lectura_diaria", "horas_trabajo", "educacion_madre", "educacion_padre", "num_libros", "dedicacion_internet", "nivel_socioeconomico", "tipo_remuneracion","punt_global", "punt_ingles", "desempenio_lectura", "desempenio_mate", "desempenio_ciencias", "desempenio_sociales")

correlation_matrix <- cor(matrix_df)

# Generar el gráfico sin valores de correlación
corrplot::corrplot(correlation_matrix, type = "lower", tl.cex=0.7)

horas_trabajo.ejecutado <- FALSE
lectura_diaria.ejecutado <- FALSE
dedicacion_internet.ejecutado <- FALSE
horas_trabajo.ejecutado <- FALSE
```

#### Qué se observa

Basándonos en la matriz de correlación, podemos inferir que las siguientes variables están correlacionadas entre sí:

* Puntaje global y desempeño en las materias: se puede evidenciar una fuerte correlación entre las materias; siendo más fuerte y positiva entre el desempeño de lectura, ciencias y sociales, así como entre matemáticas e inglés.

* Nivel socioeconómico y el desempeño en las materias: relación ligeramente fuerte y positiva entre el nivel socioeconómico y el puntaje en inglés. Además, Con el resto de materias la relación no es tan fuerte, pero sigue siendo positiva.

* El tiempo dedicado al internet con el nivel socioeconómico.

* El número de libros con el nivel socioeconómico: relación levemente fuerte y positiva; un estudiante con un buen nivel socioeconómico posee más libros en el hogar. Así mismo, Se observa una leve correlación entre la cantidad de libros y el puntaje. Aunque entre la cantidad de libros y la dedicación a leer, no, lo cual es extraño.

* Educación de los padres con el resto de variables: se evidencia que la educación de los padres tiende a ser mayor conforme el nivel socioeconómico y el estrato aumentan, esto mismo se ve reflejado en puntajes un poco más altos de forma global; específicamente en un mayor puntaje en inglés.

* Horas de trabajo y tipo de remuneración: relación fuerte y positiva; de acuerdo al tiempo trabajado será el tipo de remuneración.

Es curioso observar que la lectura diaria no tiene una fuerte correlación con los puntajes en general.

### Análisis socioeconómico {.tabset}

Se analiza la correlación entre varias variables, como el nivel socieconomico, el tipo de colegio (público/privado), el nivel educativo de los padres y el puntaje obtenido por los estudiantes.

#### Nivel socioeconómico 

Analizamos si existe una correlación entre el desempeño académico y el nivel socioeconómico del estudiante. 

Para ello, lo primero que debemos hacer es crear un dataframe con las dos variables a analizar en este caso: "ESTU_NSE_INDIVIDUAL" y "PUNT_GLOBAL":

```{r c_des_nse}
des_nse_df <- data[, c("ESTU_NSE_INDIVIDUAL", "PUNT_GLOBAL")] # Crear un nuevo dataframe con las dos columnas de interés

# Calcular correlación entre las dos variables
correlation_value <- cor(des_nse_df$ESTU_NSE_INDIVIDUAL, des_nse_df$PUNT_GLOBAL)
# Imprimir el valor de correlación
print(paste("La correlación entre NSE e PUNT_GLOBAL es:", round(correlation_value, 3)))
```

Seguido de esto procedemos a realizar una grafica que representa la distribución de los puntajes según el nivel socioeconómico (NSE) individual de los estudiantes. Cada línea de densidad coloreada representa la distribución de los puntajes para cada nivel socioeconómico. Las áreas bajo las curvas muestran la densidad relativa de los puntajes en el eje x (Puntaje global), lo que permite visualizar cómo se distribuyen los puntajes en relación con los diferentes niveles socioeconómicos.
 
```{r c_des_nse_2, fig.align='center'}
# Gráfico combinado con líneas de densidad ajustadas por clase socioeconómica
ggplot(data, aes(x = PUNT_GLOBAL, fill = as.factor(ESTU_NSE_INDIVIDUAL))) +
  geom_density(alpha = 0.6, adjust = 1) +
  labs(title = "Distribución de puntajes por nivel socioeconómico", x = "Puntaje global", y = "Densidad") +
  scale_fill_discrete(name = "Nivel socioeconómico") +
  theme_minimal()
```

En el NSE 1, se identifica una concentración significativa de estudiantes, con una distribución marcadamente sesgada hacia la derecha y una alta leptocurtosis. Su media se encuentra por debajo de los 200 puntos, lo cual es motivo de preocupación. 
Para el NSE 2, se observa una distribución también leptocúrtica, aunque menos acentuada que en el nivel anterior, con una media que no supera los 250 puntos. 
En el NSE 3, la distribución tiende a ser más similar a la normal, con una media cercana a los 375 puntos. 
Por último, el NSE 4 presenta una asimetría negativa y una distribución igualmente leptocúrtica, parecida a la del NSE 1.

El análisis revela una correlación evidente entre el desempeño académico y el nivel socioeconómico (NSE) de los estudiantes. Las observaciones destacan diferencias significativas entre los niveles socioeconómicos:

##### Nivel Socioeconómico 1 (NSE 1)
* Ausencia de recursos tecnológicos como computadoras e Internet.
* Hogares con carencias en electrodomésticos.
* Bajo nivel educativo de los padres, con predominancia de niveles de primaria incompleta.
* Madres dedicadas a labores domésticas u ocupaciones no calificadas.
* Bajo consumo de productos como leche, carne y huevos.
* Escasa tenencia de libros en el hogar.

##### Nivel Socioeconómico 2 (NSE 2)
* Aunque algunas carencias persisten, hay una leve mejora en el acceso a recursos tecnológicos.
* Niveles educativos de los padres son más variados, aunque aún predominan niveles de primaria y secundaria incompletos.
* Incremento en el consumo de productos básicos y la tenencia de libros.

##### Nivel Socioeconómico 3 (NSE 3)
* Madres con educación secundaria completa y, a veces, niveles técnicos o profesionales.
* Mayor acceso a recursos tecnológicos y electrodomésticos.
* Consumo más regular de alimentos y mayor acceso a recursos educativos.

##### Nivel Socioeconómico 4 (NSE 4)
* Hogares con amplio acceso a recursos tecnológicos como computadoras, internet y consolas de videojuegos.
* Educación de los padres en niveles profesionales o incluso de postgrado.
* Consumo regular de alimentos nutritivos y una mejor dotación de recursos educativos.

Este análisis sugiere que las diferencias socioeconómicas influyen significativamente en el acceso a recursos tecnológicos, niveles educativos de los padres, acceso a servicios y bienes, y el consumo de productos básicos. Este análisis refuerza la idea de que el nivel socioeconómico influye en el acceso a recursos y, por ende, en el desempeño académico de los estudiantes.

#### Tipo de colegio

Analizamos si el tipo de colegio (público/privado) se correlaciona con el desempeño académico intentando responder la siguiente pregunta:  ¿Los estudiantes de ciertos tipos de colegios tienen ventajas o desventajas en sus puntajes?

Para abordar esta pregunta, primero generamos un cálculo de promedios de todas las áreas que evalúa la prueba agrupados por el tipo de colegio (oficial o no oficial).
Luego, se reestructuraron los datos en un formato adecuado para un gráfico de barras apiladas. Esta reorganización se realiza utilizando la función pivot_longer para cambiar el formato de las columnas de promedio a un formato largo, donde cada fila representa un área específica con su respectivo promedio para cada tipo de colegio. Después, usamos ggplot para crear el gráfico de barras apiladas.

Finalmente, utilizamos la función cor para para calcular la correlación entre el puntaje global y el tipo de colegio para los dos tipos diferentes.

La siguiente gráfica muestra el desempeño promedio en distintas áreas académicas (lectura crítica, matemáticas, ciencias, inglés y sociales) comparando dos tipos de colegios: oficial y no oficial. 

```{r c_des_tc, fig.align='center'}
# Calcular el promedio de puntajes por tipo de colegio
promedios <- data %>%
  group_by(COLE_NATURALEZA) %>%
  summarise(
    Promedio_Lectura = mean(PUNT_LECTURA_CRITICA),
    Promedio_Matematicas = mean(PUNT_MATEMATICAS),
    Promedio_Ciencias = mean(PUNT_C_NATURALES),
    Promedio_Ingles = mean(PUNT_INGLES),
    Promedio_Sociales = mean(PUNT_SOCIALES_CIUDADANAS)
  )

# Reorganizar los datos para el gráfico de barras apiladas
stacked_data <- promedios %>%
  pivot_longer(cols = starts_with("Promedio"), names_to = "Area", values_to = "Promedio")

# Crear el gráfico de barras apiladas
ggplot(stacked_data, aes(x = COLE_NATURALEZA, y = Promedio, fill = Area)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = round(Promedio, 2)), 
            position = position_stack(vjust = 0.5), 
            color = "white", size = 4) +
  labs(title = "Desempeño promedio por área y tipo de colegio",
       x = "Tipo de colegio",
       y = "Puntaje promedio") +
  theme_minimal() +
  theme(legend.position = "right")
```

Se observa que la diferencia en el desempeño promedio por área entre colegios oficiales y no oficiales sugiere una desigualdad significativa en la calidad educativa entre estos dos tipos de colegios. Los puntajes más altos en colegios no oficiales, especialmente en inglés, matemáticas y lectura crítica, indican una posible brecha en la calidad educativa entre los dos tipos de instituciones.

```{r c_des_tc_2} 
# Calcular correlación entre puntajes y tipo de colegio
correlacion_publico <- cor(data$PUNT_GLOBAL, as.numeric(data$COLE_NATURALEZA == "OFICIAL"))

# Calcular correlación entre puntajes y tipo de colegio
correlacion_privado <- cor(data$PUNT_GLOBAL, as.numeric(data$COLE_NATURALEZA == "NO OFICIAL"))

# Mostrar la correlación
cat("La correlación entre el tipo de colegio privado y el puntaje es:", correlacion_privado)
```

La correlación positiva leve pero notable entre el tipo de colegio privado y el
desempeño académico podría sugerir que, en promedio, los estudiantes de colegios
privados tienden a obtener puntajes ligeramente más altos. Por otro lado, la
correlación negativa entre el tipo de colegio público y el puntaje podría indicar
que los estudiantes de colegios públicos, en promedio, tienden a obtener puntajes
ligeramente más bajos.

Estas diferencias en el desempeño académico entre tipos de colegios podrían
relacionarse con factores socioeconómicos. Los colegios no oficiales podrían
tener recursos financieros y pedagógicos superiores, mientras que los colegios
oficiales podrían enfrentar desafíos económicos y recursos limitados, lo que podría
impactar el nivel de educación y, por ende, el desempeño académico.

Es importante tener en cuenta que las diferencias en el desempeño académico pueden
ser multifacéticas y pueden estar influenciadas por factores más allá del tipo de
colegio, como el entorno familiar, el acceso a recursos adicionales, por eso, se
analizan más adelante.

#### Nivel educativo de los padres

Analizamos si el nivel educativo de los padres se relaciona con el desempeño
académico, intentando responder la siguiente pregunta: ¿Los hijos de padres con
niveles educativos más altos tienden a obtener mejores puntajes en las pruebas?

Para poder responder esta pregunta tuvimos que realizar el siguiente procedimiendo:
1. En este caso, se calcula la correlación entre el nivel de educación del padre y de la madre con el puntaje global de los estudiantes, antes de cambiar el tipo de datos de las columnas a factores.
2. Se hace un mapeo de los valores numéricos que representan el nivel de educación del padre y de la madre se convierten a etiquetas más descriptivas.
3. Se combinan las columnas del nivel de educación del padre y de la madre en una sola columna para facilitar la representación gráfica.
4. Se reordenan los niveles en la columna del nivel de educación para que aparezcan de manera lógica en el gráfico de caja.
5. Se crea un gráfico de caja utilizando los datos combinados. 

Este gráfico muestra la distribución del puntaje global según los niveles de educación de los padres, diferenciando entre el padre y la madre.

```{r c_des_ne, fig.align='center'}
# Calcular correlación entre las dos variables antes de cambiar los datos a factores
correlation_padre <- cor(matrix_df$educacion_padre, matrix_df$punt_global)
correlation_madre <- cor(matrix_df$educacion_madre, matrix_df$punt_global)

# Mapear los valores numéricos a sus etiquetas correspondientes

matrix_df$educacion_padre <- factor(matrix_df$educacion_padre, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10),
                                   labels = c("Ninguno", "Primaria incompleta", "Primaria completa", "Secundaria (Bachillerato) incompleta", "Secundaria (Bachillerato) completa", "Técnica o tecnológica incompleta", "Técnica o tecnológica completa", "Educación profesional incompleta", "Educación profesional completa", "Postgrado"))

matrix_df$educacion_madre <- factor(matrix_df$educacion_madre, levels = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10),
                                   labels = c("Ninguno", "Primaria incompleta", "Primaria completa", "Secundaria (Bachillerato) incompleta", "Secundaria (Bachillerato) completa", "Técnica o tecnológica incompleta", "Técnica o tecnológica completa", "Educación profesional incompleta", "Educación profesional completa", "Postgrado"))

# Combinar las columnas en una sola para el gráfico
combined_df <- matrix_df %>%
  gather(key = "tipo_educacion", value = "nivel_educacion", educacion_padre, educacion_madre)

# Reordenar niveles de la columna 'nivel_educacion'
combined_df$nivel_educacion <- factor(combined_df$nivel_educacion,
                                      levels = c("Ninguno", "Primaria incompleta", "Primaria completa",
                                                 "Secundaria (Bachillerato) incompleta", "Secundaria (Bachillerato) completa",
                                                 "Técnica o tecnológica incompleta", "Técnica o tecnológica completa",
                                                 "Educación profesional incompleta", "Educación profesional completa", "Postgrado"))

# Crear el gráfico de caja
ggplot(combined_df, aes(x = nivel_educacion, y = punt_global, fill = tipo_educacion)) +
  geom_boxplot() +
  labs(title = "Relación entre educación de los padres y puntaje global",
       x = "Nivel de educación",
       y = "Puntaje global") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar etiquetas x si es necesario
```

Se observa un hallazgo impactante: a medida que los padres alcanzan un nivel educativo
más alto, se evidencia un notable incremento en los puntajes promedio obtenidos por
sus hijos. En particular, se observa una marcada brecha entre los hijos de padres con
estudios de posgrado, cuya media supera los 330, y aquellos cuyos padres tienen nivel
educativo nulo o primario, con puntajes que no superan los 250.

```{r c_des_ne_2}
# Imprimir el valor de correlación del padre y madre
cat("La correlación entre el nivel educativo del padre y la madre con el puntaje es:", round(correlation_padre, 3), "y",  round(correlation_madre, 3), "respectivamente\n")
```

Esto se ratifica con una correlación positiva considerable entre el nivel educativo
de los padres y el desempeño académico de sus hijos, sugiriendo así que un entorno
educativo favorable puede influir de manera significativa en los logros académicos.

A su vez, el nivel educativo de los padres podría incidir en la calidad de la
enseñanza impartida a sus hijos y en la relevancia que se le otorga a la educación,
ejerciendo un efecto directo en su rendimiento académico. E incluso, podría reflejar
desigualdades en el acceso a recursos que apoyen el proceso educativo, tema estudiado
más adelante.

### Acceso a recursos

#### Computador e Internet

Analizamos si el el acceso a recursos, específicamente, computador e Internet,
se relaciona con el puntaje obtenido, itentando responder la siguiente pregunta:
¿la disponibilidad de recursos en casa (computadora o Internet) se relaciona con
el rendimiento académico? 

Para poder responder esta pregunta, primero filtramos los datos, convirtiendo los 
valores vacíos en las columnas de interés a NA y luego eliminadolos, después, creamos
una nueva columna que irá en el nuevo dataframe la cual contiene "Sí" para aquellos
estudiantes que tienen el recurso y "No" para los que no lo tienen. Luego convierte el valor en las columnas a 1 o 0 y calcula la correlación entre estos valores y los
puntajes globales. Por último, se genera dos gráficos de caja, uno para los puntajes según el acceso a un computador y otro para los puntajes según el acceso a Internet. 

```{r cor_tienepc_punt}
# Filtrar los datos y crear una nueva columna indicando si tiene computador
data_pc <- data %>%
  mutate(FAMI_TIENECOMPUTADOR = na_if(FAMI_TIENECOMPUTADOR, "")) %>%
  filter(!is.na(FAMI_TIENECOMPUTADOR)) %>%
  mutate(TieneComputador = ifelse(FAMI_TIENECOMPUTADOR == "Si", "Sí", "No")) %>%
  select(TieneComputador, PUNT_GLOBAL)

# Calcular correlación entre puntajes y tener computadora
correlacion_con_pc <- cor(data_pc$PUNT_GLOBAL, as.numeric(data_pc$TieneComputador == "Sí"))

# Calcular correlación entre puntajes y tener computadora
correlacion_sin_pc <- cor(data_pc$PUNT_GLOBAL, as.numeric(data_pc$TieneComputador == "No"))
```

```{r cor_tieneint_punt}
# Filtrar los datos y crear una nueva columna indicando si tiene Internet
data_internet <- data %>%
  mutate(FAMI_TIENEINTERNET = na_if(FAMI_TIENEINTERNET, "")) %>%
  filter(!is.na(FAMI_TIENEINTERNET)) %>%
  mutate(TieneInternet = ifelse(FAMI_TIENEINTERNET == "Si", "Sí", "No")) %>%
  select(TieneInternet, PUNT_GLOBAL)

# Calcular correlación entre puntajes y tener Internet
correlacion_con_internet <- cor(data_internet$PUNT_GLOBAL, as.numeric(data_internet$TieneInternet == "Sí"))

# Calcular correlación entre puntajes y tener Internet
correlacion_sin_internet <- cor(data_internet$PUNT_GLOBAL, as.numeric(data_internet$TieneInternet == "No"))
```

El primer diagrama de caja (izquierda) representa la distribución de los puntajes globales entre aquellos que tienen y no tienen computadora.

El segundo diagrama de caja (derecha) hace lo mismo pero para aquellos que tienen y no tienen acceso a Internet.

```{r c_internet_des, fig.align='center'}
# Gráfico 1: Puntajes según el acceso a un computador
plot_pc <- ggplot(data_pc, aes(x = TieneComputador, y = PUNT_GLOBAL, fill = TieneComputador)) +
  geom_boxplot() +
  labs(title = NULL,
       x = "Tiene computador",
       y = "Puntaje global") +
  theme_classic() +
  guides(fill = FALSE)  # Ocultar la leyenda de color

# Gráfico 2: Puntajes según el acceso a Internet
plot_internet <- ggplot(data_internet, aes(x = TieneInternet, y = PUNT_GLOBAL, fill = TieneInternet)) +
  geom_boxplot() +
  labs(title = NULL,
       x = "Tiene Internet",
       y = "Puntaje global") +
  theme_classic() +
  guides(fill = FALSE)  # Ocultar la leyenda de color

# Organizar los gráficos en una sola ventana gráfica
grid.arrange(plot_pc, plot_internet, ncol = 2, top = "Puntajes según acceso a un computador o Internet")
```

Efectivamente sí, tener acceso a un computador o Internet influye fuertemente en el
puntaje obtenido, en el caso de tener un computador se observa que los estudiantes
que no tienen acceso a este recurso obtuvieron una media inferior a 230 puntos,
mientras que los que sí tenían obtuvieron una media superior a los 270 puntos, de
igual manera con el acceso a Internet.

Estos hallazgos destacan la influencia crucial del acceso a recursos tecnológicos
en el rendimiento académico. La brecha entre aquellos con y sin acceso a computadoras
e Internet es evidente, con puntajes significativamente diferentes.

```{r c_internet_des_cor}
# Mostrar la correlación de no tener los recursos
cat("La correlación entre tener no computador o Internet y el puntaje son:", correlacion_sin_pc, "y",correlacion_sin_internet, "respectivamente\n")
```

Las correlaciones subrayan esta relación: no tener estos recursos correlaciona
negativamente con los puntajes. Esto apunta a desigualdades socioeconómicas
en el acceso a recursos, impactando la calidad educativa y evidenciando la importancia
de cerrar estas brechas para una educación equitativa. 

Aunque tener acceso a estos recursos puede impactar positivamente, el tiempo
que se dedica a estos recursos de manera no adecuada puede ser contraproducente,
pero para no hacer suposiciones decidimos comprobarlo en el análisis de uso de tiempo.

### Uso de tiempo {.tabset}

#### Tiempo dedicado a Internet

Analizamos si el tiempo dedicado a Internet, excluyendo actividades académicas,
se relaciona con el puntaje obtenido. Intentando responder la siguiente pregunta: ¿El tiempo que pasan los jovenes en internet afecta a su puntaje en las pruebas ICFES? 
Y partiendo de la suposición que más tiempo en línea implicaría peores resultados.

Para abordar esta pregunta, es conveniente tratar los datos como factores para agregar 
jerarquía o niveles a los mismos. Esto da cierta facilidad a la hora de graficar 
los valores y, tiene un mejor comportamiento, puesto que los datos ya están ordenados por 
niveles sin necesidad de realizar una operación de ordenamiento. Para realizar esta 
conversión, se necesita pasar por un condicional que valide si la operacion ya se hizo (de 
no hacerse esta condición, al ejecutar el código mas de dos veces, se generan errores con 
los factores y son reemplazados por "NaN"). si la conversión no se ha realizado, se realiza 
dentro del condicional cambiando los valores numéricos por factores.

Posterior a esto, se hace la gráfica de "dedicacion_internet" vs "punt_global" con la 
función geom_boxplot de ggplot. 

Por último, se hace el cálculo de la correlación entre el puntaje y la dedicación a internet.

La siguiente gráfica muestra la distribución de los puntajes globales en función del tiempo dedicado a actividades en Internet, excluyendo las académicas, por parte de los estudiantes.

```{r c_des_dint, fig.align='center'}
# Mapear los valores numéricos a sus etiquetas correspondientes
if (dedicacion_internet.ejecutado == FALSE) {
  matrix_df$dedicacion_internet <- factor(matrix_df$dedicacion_internet, levels = c(1, 2, 3, 4),
                                   labels = c("No navega en Internet", "30 minutos o menos", "Entre 1 y 3 horas", "Más de 3 horas"))
  
  dedicacion_internet.ejecutado = TRUE
}

# Crear el gráfico de caja
ggplot(matrix_df, aes(x = dedicacion_internet, y = punt_global)) +
  geom_boxplot(fill = "darkgreen", color = "black", alpha = 0.7, outlier.color = "black") +
  labs(title = "Distribución de puntajes por tiempo dedicado a Internet",
       x = "Tiempo en Internet",
       y = "Puntaje global") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar etiquetas x si es necesario
```

La dedicación a Internet, sorprendentemente, parece correlacionarse positivamente con los puntajes obtenidos en las pruebas, contradiciendo la suposición de que más tiempo en línea implicaría peores resultados. Los estudiantes con más horas en Internet promedian puntajes superiores a 250, mientras que aquellos que no navegan rondan los 210.

```{r c_des_dint_2, fig.align='center'}

# Calcular correlación entre puntajes y tener computadora
correlacion <- cor(matrix_df$punt_global, as.numeric(matrix_df$dedicacion_internet))

# Mostrar la correlación
cat("La correlación entre el tiempo dedicado a Internet y el puntaje es:", correlacion)
```

Esta correlación positiva sugiere que hay una relación moderada entre el tiempo dedicado a Internet y los puntajes obtenidos en las pruebas. Mientras más tiempo pasan los estudiantes en línea, tienden a obtener puntajes más altos. Sin embargo, la correlación no implica causalidad y otros factores podrían influir en estos resultados. 

Además, podría reflejar una brecha digital: aquellos que no navegan en Internet tienen puntajes más bajos, lo que se vincula con las diferencias socioeconómicas y de acceso a recursos.

#### Tiempo dedicado a leer 

¿Hay alguna relación entre el tiempo dedicado a leer por entretenimiento y los puntajes? 

Una vez respondida la pregunta anterior, esta se torna más sencilla, ya que sigue los mismo pasos.<br>
Se realiza una condición para no sobrescribir los valores si ya fueron cambiados.  Si la conversión aún no se ha realizado,
se ingresa al condicional y se convierten los valores numéricos a factores. <br>
Se grafica la relación entre 'lectura_diaria' y 'punt_global'.<br>
Luego, se calcula e imprime el coeficiente de correlación de ambas variables.
```{r c_des_dlec, fig.align='center'}
# Mapear los valores numéricos a sus etiquetas correspondientes
if (lectura_diaria.ejecutado == FALSE) {
  matrix_df$lectura_diaria <- factor(matrix_df$lectura_diaria, levels = c(1, 2, 3, 4, 5),
                                   labels = c("No leo por entretenimiento", "30 minutos o menos",
                                              "Entre 30 y 60 minutos", "Entre 1 y 2 horas",
                                              "Más de 2 horas"))
  lectura_diaria.ejecutado = TRUE
}



# Crear el gráfico de caja
ggplot(matrix_df, aes(x = lectura_diaria, y = punt_global)) +
  geom_boxplot(fill = "lightblue", color = "darkblue", alpha = 0.7, outlier.color = "black") +
  labs(title = "Distribución de puntajes por tiempo de lectura diaria",
       x = "Tiempo de lectura",
       y = "Puntaje global") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Calcular correlación entre puntajes y tener computadora
correlacion <- cor(matrix_df$punt_global, as.numeric(matrix_df$lectura_diaria))

# Mostrar la correlación
cat("La correlación entre el tiempo dedicado a leer y el puntaje es:", correlacion)

```

No hay una gran diferencia en los puntajes promedio de las personas que no leen por entretenimiento y las que leen 30 minutos o menos, lo que indica que una lectura de menos de 30 minutos no genera un alto impacto en el puntaje.De igual forma, la diferencia entre leer 30 a 60 minutos y leer entre 1 y 2 horas no es muy significativa. Incluso se puede observar un muy ligero descenso.  
Mientras que, la diferencia mas grande de puntajes promedio respecto de los demás lo tienen las personas que leen más de 2 horas diarias, siendo notablemente superior que el promedio de las personas que leen entre 1 y 2 horas.
```{r prom3}
  prom_no_leen <- mean(matrix_df$punt_global[matrix_df$lectura_diaria == "No leo por entretenimiento"], na.rm = TRUE)
  prom_30_min <- mean(matrix_df$punt_global[matrix_df$lectura_diaria == "30 minutos o menos"], na.rm = TRUE)
  prom_60min <- mean(matrix_df$punt_global[matrix_df$lectura_diaria == "Entre 30 y 60 minutos"], na.rm = TRUE)
  prom_2horas <- mean(matrix_df$punt_global[matrix_df$lectura_diaria == "Entre 1 y 2 horas"], na.rm = TRUE)
  prom_mas2horas <- mean(matrix_df$punt_global[matrix_df$lectura_diaria == "Más de 2 horas"], na.rm = TRUE)
  
  cat("la media de puntajes de personas que no leen por entretenimiento es de ",prom_no_leen,",y para personas que leen 30 minutos o menos es de",prom_30_min, "\n")

  cat("la media de puntajes de personas que leen de 30 a 60 minuros es de ",prom_60min,",y para personas que leen de 1 a 2 horas es de ",prom_2horas, "\n")
  
  cat("la media de puntajes de personas que leen mas de 2 horas diarias es de ",prom_mas2horas, "\n")
```

Si bien la diferencia entre algunos niveles y sus niveles posteriores no es muy amplia, si se observa la diferencia en bloques de 0 a 30 minutos, 30 minutos a 2 horas y mas de 2 horas de lectura diaria. Hay sobre todo una diferencia radical entre leer menos de media hora y leer mas de 2 horas, pasando de una media de 245 a una de 270 puntos.

#### Tiempo dedicado a trabajar
¿Tener un trabajo afecta en los puntajes obtenidos en la prueba?

Esta pregunta comparte procedimiento con el análisis de las preguntas anteriores:
- se hace la conversión a factor de los valores guardados en la columna 'horas_trabajo.
- Se crea la gráfica teniendo de base las horas de trabajo y el puntaje global (como X y Y) de matrix_df.
- Finalmente, se halla el coeficiente de correlación.

```{r c_des_dtrab, fig.align='center'}
# Mapear los valores numéricos a sus etiquetas correspondientes
if (horas_trabajo.ejecutado == FALSE) {
  matrix_df$horas_trabajo <- factor(matrix_df$horas_trabajo, levels = c(1, 2, 3, 4, 5),
                                   labels = c("0", "Menos de 10 horas", "Entre 11 y 20 horas", "Entre 21 y 30 horas", "Más de 30 horas"))
  horas_trabajo.ejecutado = TRUE
}

# Crear el gráfico de caja
ggplot(matrix_df, aes(x = horas_trabajo, y = punt_global)) +
  geom_boxplot(fill = "chocolate4", color = "blue4", alpha = 0.7, outlier.color = "black") +
  labs(title = "Distribución de puntajes por tiempo de trabajo semanal",
       x = "Tiempo de trabajo",
       y = "Puntaje global") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar etiquetas x si es necesario

# Calcular correlación entre puntajes y tener computadora
correlacion <- cor(matrix_df$punt_global, as.numeric(matrix_df$horas_trabajo))

# Mostrar la correlación
cat("La correlación entre el tiempo dedicado a trabajar en la semana y el puntaje es:", correlacion)

```
Lo siguiente muestra si los estudiantes que dijeron que trabajaban reciben pago o no.<br>
Se crea un nuevo dataframe filtrando por los estudiantes que trabajan y, a este nuevo dataframe,
se le agrega una nueva columna 'Tipo_Remuneracion_Agrupado' donde se agrupan aquellos
que reciben pago en efectivo, especie o ambas; el otro valor en esta columna es 'No'.

```{r c_des_dtrab_2, fig.align='center'}
# Mapear los valores numéricos a sus etiquetas correspondientes para tipo de remuneración
  matrix_df$tipo_remuneracion <- factor(matrix_df$tipo_remuneracion, levels = c(1, 2, 3, 4),
                                   labels = c("No", "Si, en efectivo", "Si, en efectivo y especie", "Si, en especie"))


# Agrupar los estudiantes por tipo de remuneración
trabajo_mas_20_horas <- matrix_df %>%
  filter(horas_trabajo %in% c("Menos de 10 horas","Entre 11 y 20 horas","Entre 21 y 30 horas", "Más de 30 horas")) %>%
  mutate( # Filtrar estudiantes que trabajan entre 21 y 30 horas y más de 30 horas
    Tipo_Remuneracion_Agrupado = case_when(
      tipo_remuneracion %in% c("Si, en efectivo", "Si, en efectivo y especie", "Si, en especie") ~ "Sí, en efectivo, especie o ambas",
      TRUE ~ tipo_remuneracion  # Mantener otros valores sin modificar
    )
  )

# Crear el diagrama de barras para el tipo de remuneración
ggplot(trabajo_mas_20_horas, aes(x = Tipo_Remuneracion_Agrupado)) +
  geom_bar() +
  labs(title = "¿Usted recibe algún tipo de remuneración por trabajar?",
       x = "Tipo de remuneración",
       y = "Cantidad de estudiantes")
```

A nivel académico, se puede observar que el trabajar afecta en cierta medida los puntajes obtenidos en las pruebas, descendiendo el puntaje promedio de 261 puntos para personas que no trabajan a 228 para personas que trabajan más de 30 horas semanales, un cambio bastante significativo.

Pero esto impacta aún más cuando se analiza que la edad media de las personas que presentan este examen es entre 16 y 18 años. Por ende, se puede intuir que hay jóvenes que se ven forzados a dejar sus estudios de lado para conseguir un empleo, siendo esto a su vez influyente en el puntaje obtenido en sus pruebas ICFES y, probablemente, en su futuro, ya que estas pruebas son decisivas a la hora de entrar a una universidad pública o "de bajo costo", la cual quizá sea su única oportunidad para acceder a un nivel de educación superior.

### Análisis demografico {.tabset}

#### Promedio de notas en deptos y municipio
1. ¿Hay diferencia entre la media de puntajes obtenidos en distintos departamentos de Colombia?<br>
2. ¿Qué tanta diferencia hay entre municipios de Santander?<br>

Para este análisis, correspondiente al mapeo de los promedios de puntajes por departamentos y municipios, se lleva a cabo: <br>
Cargar los mapas corresponientes a departamentos y municipios. <br>
Separar los datos y calcular la media del puntaje por departamento o municipio respectivamente.<br>
Arreglar datos, eliminando casos especiales y cambiando nombres de columnas y tipos de datos.<br>
JOIN entre el mapa y los puntajes.<br>
Graficación.

```{r Promedio de notas en los departamentos de Colombia y municipios de Santander, fig.align='center'}
## Cargando el mapa respectivo
map_departamentos <- st_read("MGN2022_DPTO_POLITICO/MGN_DPTO_POLITICO.shp")
map_municipios <- st_read("MGN2022_MPIO_POLITICO/MGN_MPIO_POLITICO.shp")

## Separando y arreglando los datos de interés de "data"
Puntaje.Depto <- aggregate(PUNT_GLOBAL ~ ESTU_COD_RESIDE_DEPTO, FUN = mean, data = data)
Puntaje.Depto <- Puntaje.Depto[-34,]
colnames(Puntaje.Depto) <- c('DPTO_CCDGO', 'PUNTAJE')

Puntaje.MPIO <- aggregate(PUNT_GLOBAL ~ ESTU_COD_RESIDE_MCPIO, FUN = mean, data = data)
Puntaje.MPIO <- Puntaje.MPIO[-1118,]
colnames(Puntaje.MPIO) <- c('MPIO_CDPMP', 'PUNTAJE')

map_departamentos$DPTO_CCDGO <- as.numeric(map_departamentos$DPTO_CCDGO)
map_municipios$MPIO_CDPMP <- as.numeric(map_municipios$MPIO_CDPMP)
## Uniendo tablas
mapJoin_Depto <- left_join(map_departamentos, Puntaje.Depto)
mapJoin_MPIO <- left_join(map_municipios, Puntaje.MPIO)

## Graficando
tmap_options(check.and.fix = TRUE)

plot_Colombia <- tm_layout(title = "Promedio de puntajes en Colombia", title.position = c("center", "top"), title.size = 1.0, legend.text.size = 0.65) +
  qtm(mapJoin_Depto,"PUNTAJE", fill.breaks = c(0, 200, 210, 220, 230, 240, 250, 260, 270, 280, 300), fill.palette = c("red", "yellow", "green"))

plot_Santander <- tm_layout(title = "Promedio de puntajes en Santander", title.position = c("center", "top"), title.size = 1.0, legend.show = FALSE) +
  qtm(mapJoin_MPIO[mapJoin_MPIO$DPTO_CCDGO=="68",],"PUNTAJE", fill.breaks = c(0, 200, 210, 220, 230, 240, 250, 260, 270, 280, 300), fill.palette = c("red", "yellow", "green"))

tmap_arrange(plot_Colombia, plot_Santander, ncol = 2)

Media_Puntajes <- mean(data$PUNT_GLOBAL)

cat("Para mayor comprensión, la media de puntajes de las pruebas ICFES a nivel nacional es de:", Media_Puntajes)
 
```

Estas gráficas brindan mucha información. En primer lugar, se puede observar que en la región andina hay una tendencia a obtener puntajes por encima de la media de 251 puntos, siendo esta la región con mejor desempeño. A su vez, el departamento de Bogotá DC es el departamento con la mejor media de puntajes, siendo esta de 271 puntos.<br>
Por otro lado, las regiones periféricas de Colombia tienden a tener un desempeño más bajo en las pruebas. Departamentos como Magdalena, La Guajira, Vaupés, Amazonas, entre otros, tienen un desempeño promedio menor a 230. Sin embargo, el departamento con un menor desempeño en las pruebas ICFES es Chocó, con tan solo 207 puntos de media. Esto puede deberse a una educación deficiente o al difícil acceso a recursos en los departamentos teñidos de colores rojizos, de los cuales se tiene conocimiento de su difícil panorama tecnológico, social, económico, entre otras características que pueden ser causantes del bajo rendimiento educativo.<br>
Finalmente, en el departamento de Santander se puede observar un comportamiento superior a la media en general. Bucaramanga, Floridablanca, Girón y Piedecuesta son los municipios con un mejor rendimiento, evidenciándose un comportamiento ligeramente bajo en las regiones de Puerto Wilches y Puerto Parra.

#### Comparacion zonas urbanas y rurales 
¿Existe diferencia entre la educación en zonas urbanas y la educación en zonas rurales?

Siguiendo el procedimiento de la pregunta anterior, este análisis consiste en: <br>
Separar los datos de los estudiantes en dos conjuntos según la zona (urbano y rural). <br>
Eliminar los datos no relevantes para la pregunta y conservar únicamente el departamento y la media del puntaje para cada conjunto de estudiantes.<br>
Realizar el JOIN. <br>
Generar gráficos.

```{r Mapeo de promedio de colegios en zona urbana y rural, fig.align='center'}
## Separando datos Urbano/Rural
dataUrbano <- data[data$COLE_AREA_UBICACION=="URBANO",]
dataRural <- data[data$COLE_AREA_UBICACION=="RURAL",]

## Areglando datos
Puntaje.Urbano <- aggregate(PUNT_GLOBAL~ESTU_COD_RESIDE_DEPTO, FUN = mean, data = dataUrbano)
Puntaje.Rural <- aggregate(PUNT_GLOBAL~ESTU_COD_RESIDE_DEPTO, FUN = mean, data = dataRural)

Puntaje.Urbano=Puntaje.Urbano[-34,]
colnames(Puntaje.Urbano) <- c('DPTO_CCDGO','PUNTAJE')
colnames(Puntaje.Rural) <- c('DPTO_CCDGO','PUNTAJE')

## Uniendo tablas
mapJoinUrbano <- left_join(map_departamentos, Puntaje.Urbano)
mapJoinRural <- left_join(map_departamentos, Puntaje.Rural)

## Graficando
plot_Urbano <- tm_layout(title = "Promedio de puntajes en zonas Urbanas", title.position = c("center", "top"), title.size = 1.0, legend.text.size = 0.65) +
  qtm(mapJoinUrbano,"PUNTAJE", fill.breaks = c(0,200,210,220,230,240,250,260,270,280), fill.palette = c("red", "yellow", "green")) # Para todo el pais
plot_Rural <- tm_layout(title = "Promedio de puntajes en zonas Rurales", title.position = c("center", "top"), title.size = 1.0, legend.show = FALSE) +
  qtm(mapJoinRural,"PUNTAJE", fill.breaks = c(0,200,210,220,230,240,250,260,270,300), fill.palette = c("red", "yellow", "green")) # Para todo el pais

tmap_arrange(plot_Urbano, plot_Rural, ncol = 2)

```

Estos dos mapas muestran una realidad social preocupante en Colombia. El único departamento que mantiene su puntaje tanto en zonas rurales como urbanas es Bogotá. Los demás departamentos tienen puntajes más bajos en las zonas rurales, habiendo casos extremos como Guanía, en el cual se tiene un promedio de más de 250 puntos en las zonas urbanas, mientras que en sus zonas rurales los puntajes caen estrepitosamente a valores promedio menores a 200 puntos. Estos datos generan una visión real del abandono de las zonas rurales por parte del país y de la desigualdad que hay en el mismo.<br>
Estos resultados por parte de la población rural en Colombia pueden deberse a la dificultad de acceso a la educación y a la tecnología, al alto nivel de trabajo infantil que hay en estas zonas, a la falta de oportunidades, entre muchas otras dificultades que viven día a día los habitantes de las zonas rurales de Colombia.

## Conclusiones


- El hábito de la lectura es un factor que puede afectar positivamente a los resultados obtenidos; sin embargo, la diferencia en la mayoría de los casos no es muy significativa. Solo se destaca una diferencia marcada entre leer menos de media hora y más de 2 horas, con un aumento significativo de la media, de 245 a 270 puntos.

- La correlación negativa entre el trabajo y los puntajes en las pruebas ICFES resalta un impacto significativo, especialmente en personas que trabajan más de 30 horas semanales, causando que jóvenes no se desempeñen bien en las mismas, siendo afectados no solo en su puntaje sino también en su futuro educativo y profesional.

- Se resalta una disparidad en el nivel educativo en Colombia de acuerdo a sus zonas, siendo la región Andina la zona con un mejor desempeño académico en las pruebas ICFES, mientras que las regiones periféricas del país enfrentan desafíos significativos en su calidad educativa, viéndose reflejado en menores puntajes en las pruebas Saber 11.

- En Colombia, hay una divergencia alarmante en el nivel educativo entre las zonas urbanas y rurales. La marcada brecha refleja la desigualdad social y el abandono de las áreas rurales en el país.

## Referencias
- ICFES (2023). DataIcfes. Saber 11. https://www.icfes.gov.co/web/guest/data-icfes
- Auguié, B. (2019, July 13). Laying out multiple plots on a page. https://cran.r-project.org/web/packages/egg/vignettes/Ecosystem.html
- Holtz, Y. (n.d.). An overview of color names in R. https://r-graph-gallery.com/42-colors-names.html
- DANE.gov.co (2023, April 3).  Descargas MGN 2022. Geoportal DANE.https://geoportal.dane.gov.co/descargas/mgn_2022/
